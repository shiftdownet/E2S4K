#-----------------------------------------------------------------------------------------------#
#
# @file         addroot.ps1
# @Description  N.A
# @Author       H.Nakayama
#
#-----------------------------------------------------------------------------------------------#
#-----------------------------------------------------------------------------------------------#
# Import
#-----------------------------------------------------------------------------------------------#
# Nothing

#-----------------------------------------------------------------------------------------------#
# Environment setting
#-----------------------------------------------------------------------------------------------#
# Set-StrictMode -Version Latest

#-----------------------------------------------------------------------------------------------#
# Parameters 
#-----------------------------------------------------------------------------------------------#
Param([String]$json_path = "", [String]$output_path = "")

#-----------------------------------------------------------------------------------------------#
# Functions
#-----------------------------------------------------------------------------------------------#
#-----------------------------------------------------------#
#
# Entry Point ( Called by end of this file )
#
#-----------------------------------------------------------#
function main() {
    if ( $json_path -eq "" ) {
        Write-Host "Aruguments are invalid. Please refer to the following"
        Write-Host "  json_path [FileName]"
    }
    else {
        $root = [PSCustomObject]@{ root = @() }
        (Get-Content $json_path | Out-String | ConvertFrom-Json) | forEach-Object {
            $root.root += $_
        }
        
        $root | ConvertTo-Json | Out-String | % { [Text.Encoding]::UTF8.GetBytes($_) } | Set-Content -Path $output_path -Encoding Byte
    }
}

#-----------------------------------------------------------------------------------------------#
# Code block 
#-----------------------------------------------------------------------------------------------#
# Call the main function.
main

#-----------------------------------------------------------------------------------------------#
